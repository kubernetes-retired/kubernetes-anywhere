{
  "apiVersion": "v1",
  "kind": "List",
  "items": [
    {
      "kind": "ClusterRole",
      "apiVersion": "rbac.authorization.k8s.io/v1beta1",
      "metadata": {
        "name": "flannel"
      },
      "rules": [
        {
          "apiGroups": [
            ""
          ],
          "resources": [
            "pods"
          ],
          "verbs": [
            "get"
          ]
        },
        {
          "apiGroups": [
            ""
          ],
          "resources": [
            "nodes"
          ],
          "verbs": [
            "list",
            "watch"
          ]
        },
        {
          "apiGroups": [
            ""
          ],
          "resources": [
            "nodes/status"
          ],
          "verbs": [
            "patch"
          ]
        }
      ]
    },
    {
      "kind": "ClusterRoleBinding",
      "apiVersion": "rbac.authorization.k8s.io/v1beta1",
      "metadata": {
        "name": "flannel"
      },
      "roleRef": {
        "apiGroup": "rbac.authorization.k8s.io",
        "kind": "ClusterRole",
        "name": "flannel"
      },
      "subjects": [
        {
          "kind": "ServiceAccount",
          "name": "flannel",
          "namespace": "kube-system"
        }
      ]
    },
    {
      "apiVersion": "v1",
      "kind": "ServiceAccount",
      "metadata": {
        "name": "flannel",
        "namespace": "kube-system"
      }
    },
    {
      "kind": "ConfigMap",
      "apiVersion": "v1",
      "metadata": {
        "name": "kube-flannel-cfg",
        "namespace": "kube-system",
        "labels": {
          "tier": "node",
          "app": "flannel"
        }
      },
      "data": {
        "cni-conf.json": "{\n  \"name\": \"cbr0\",\n  \"plugins\": [\n    {\n      \"type\": \"flannel\",\n      \"delegate\": {\n        \"hairpinMode\": true,\n        \"isDefaultGateway\": true\n      }\n    },\n    {\n      \"type\": \"portmap\",\n      \"capabilities\": {\n        \"portMappings\": true\n      }\n    }\n  ]\n}\n",
        "net-conf.json": "{\n  \"Network\": \"10.244.0.0/16\",\n  \"Backend\": {\n    \"Type\": \"vxlan\"\n  }\n}\n"
      }
    },
    {
      "apiVersion": "extensions/v1beta1",
      "kind": "DaemonSet",
      "metadata": {
        "name": "kube-flannel-ds",
        "namespace": "kube-system",
        "labels": {
          "tier": "node",
          "app": "flannel"
        }
      },
      "spec": {
        "template": {
          "metadata": {
            "labels": {
              "tier": "node",
              "app": "flannel"
            }
          },
          "spec": {
            "hostNetwork": true,
            "nodeSelector": {
              "beta.kubernetes.io/arch": "amd64"
            },
            "tolerations": [
              {
                "key": "node-role.kubernetes.io/master",
                "operator": "Exists",
                "effect": "NoSchedule"
              }
            ],
            "serviceAccountName": "flannel",
            "initContainers": [
              {
                "name": "install-cni",
                "image": "quay.io/coreos/flannel:v0.10.0-amd64",
                "command": [
                  "cp"
                ],
                "args": [
                  "-f",
                  "/etc/kube-flannel/cni-conf.json",
                  "/etc/cni/net.d/10-flannel.conflist"
                ],
                "volumeMounts": [
                  {
                    "name": "cni",
                    "mountPath": "/etc/cni/net.d"
                  },
                  {
                    "name": "flannel-cfg",
                    "mountPath": "/etc/kube-flannel/"
                  }
                ]
              }
            ],
            "containers": [
              {
                "name": "kube-flannel",
                "image": "quay.io/coreos/flannel:v0.10.0-amd64",
                "command": [
                  "/opt/bin/flanneld"
                ],
                "args": [
                  "--ip-masq",
                  "--kube-subnet-mgr"
                ],
                "resources": {
                  "requests": {
                    "cpu": "100m",
                    "memory": "50Mi"
                  },
                  "limits": {
                    "cpu": "100m",
                    "memory": "50Mi"
                  }
                },
                "securityContext": {
                  "privileged": true
                },
                "env": [
                  {
                    "name": "POD_NAME",
                    "valueFrom": {
                      "fieldRef": {
                        "fieldPath": "metadata.name"
                      }
                    }
                  },
                  {
                    "name": "POD_NAMESPACE",
                    "valueFrom": {
                      "fieldRef": {
                        "fieldPath": "metadata.namespace"
                      }
                    }
                  }
                ],
                "volumeMounts": [
                  {
                    "name": "run",
                    "mountPath": "/run"
                  },
                  {
                    "name": "flannel-cfg",
                    "mountPath": "/etc/kube-flannel/"
                  }
                ]
              }
            ],
            "volumes": [
              {
                "name": "run",
                "hostPath": {
                  "path": "/run"
                }
              },
              {
                "name": "cni",
                "hostPath": {
                  "path": "/etc/cni/net.d"
                }
              },
              {
                "name": "flannel-cfg",
                "configMap": {
                  "name": "kube-flannel-cfg"
                }
              }
            ]
          }
        }
      }
    }
  ]
}
