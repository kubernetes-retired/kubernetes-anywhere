{
    "apiVersion": "extensions/v1beta1",
    "kind": "DaemonSet",
    "metadata": {
        "name": "weave-net",
        "namespace": "kube-system"
    },
    "spec": {
        "template": {
            "metadata": {
                "labels": {
                    "name": "weave-net"
                }
            },
            "spec": {
                "hostNetwork": true,
                "hostPID": true,
                "containers": [
                    {
                        "name": "weave",
                        "image": "weaveworks/weave-kube:2.0.5",
                        "command": [
                            "/home/weave/launch.sh"
                        ],
                        "livenessProbe": {
                            "initialDelaySeconds": 30,
                            "httpGet": {
                                "host": "127.0.0.1",
                                "path": "/status",
                                "port": 6784
                            }
                        },
                        "securityContext": {
                            "privileged": true
                        },
                        "volumeMounts": [
                            {
                                "name": "weavedb",
                                "mountPath": "/weavedb"
                            },
                            {
                                "name": "cni-bin",
                                "mountPath": "/host/opt"
                            },
                            {
                                "name": "cni-bin2",
                                "mountPath": "/host/home"
                            },
                            {
                                "name": "cni-conf",
                                "mountPath": "/host/etc"
                            },
                            {
                                "name": "dbus",
                                "mountPath": "/host/var/lib/dbus"
                            },
                            {
                                "name": "lib-modules",
                                "mountPath": "/lib/modules"
                            },
                            {
                                "name": "xtables-lock",
                                "mountPath": "/run/xtables.lock"
                            }
                        ],
                        "resources": {
                            "requests": {
                                "cpu": "10m"
                            }
                        }
                    },
                    {
                        "name": "weave-npc",
                        "image": "weaveworks/weave-npc:2.0.5",
                        "resources": {
                            "requests": {
                                "cpu": "10m"
                            }
                        },
                        "securityContext": {
                            "privileged": true
                        },
                        "volumeMounts": [
                            {
                                "name": "xtables-lock",
                                "mountPath": "/run/xtables.lock"
                            }
                        ]
                    }
                ],
                "restartPolicy": "Always",
                "tolerations": [
                    {
                        "key": "node-role.kubernetes.io/master",
                        "effect": "NoSchedule"
                    }
                ],
                "serviceAccountName": "weave-net",
                "securityContext": {
                    "seLinuxOptions": {
                        "type": "spc_t"
                    }
                },
                "volumes": [
                    {
                        "name": "weavedb",
                        "emptyDir": {}
                    },
                    {
                        "name": "cni-bin",
                        "hostPath": {
                            "path": "/opt"
                        }
                    },
                    {
                        "name": "cni-bin2",
                        "hostPath": {
                            "path": "/home"
                        }
                    },
                    {
                        "name": "cni-conf",
                        "hostPath": {
                            "path": "/etc"
                        }
                    },
                    {
                        "name": "dbus",
                        "hostPath": {
                            "path": "/var/lib/dbus"
                        }
                    },
                    {
                        "name": "lib-modules",
                        "hostPath": {
                            "path": "/lib/modules"
                        }
                    },
                    {
                        "name": "xtables-lock",
                        "hostPath": {
                            "path": "/run/xtables.lock"
                        }
                    }
                ]
            }
        }
    }
}
